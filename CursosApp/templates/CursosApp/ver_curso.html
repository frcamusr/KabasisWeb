{% extends "KabasisWebApp/base.html" %}

{% block content %}
<section class="page-section cta" style="margin-top: 30px; margin-bottom: 30px;">
    
    <h1 style="text-align: center; color: white;">{{ curso.nombre | upper }}</h1>
    <div class="container">
        <div class="text-center">
            <a class="btn btn-info btn-block" href="{% url 'listar_unidad' curso.id%}" style="margin-bottom: 20px;">Administrar unidades</a>
        </div>
        <div class="text-center" style="margin-bottom: 20px;">
            <a class="btn btn-success btn-block" href="{% url 'listar_video' curso.id %}">Administrar videos</a>
        </div>
        <div style="color: white;" class="row">
            <div class="col-md-4">
                <div class="mt-3">
                    {% for unidad in unidades %}
                        <button class="oval-button mb-3 {% if forloop.first %}selected{% endif %}" data-unidad-id="{{ unidad.id }}" onclick="handleButtonClick('{{ unidad.titulo }}')">
                            {{ unidad.titulo }}
                        </button>
                    {% endfor %}
                </div>
            </div>
            
            <div class="col-md-8">
                <div class="text-center p-4 kabasis-color"
                    style="border: 0.3cm solid #296FFA; border-radius: 5px; height:70vh">
                    <h2 style="margin-bottom: 0;">Sin Contenido</h2>

                    {% for unidad in unidades %}
                        <a class="btn btn-primary" href="{% url 'ver_videos' unidad.id %}" style="display: none; margin-top: 50px;">Ver Videos</a>
                    {% endfor %}
                    

                </div>
            </div>

        </div>
    </div>
</section>

<style>
    .oval-button {
        width: 220px;
        height: 100px;
        background-image: linear-gradient(to top, rgba(150, 0, 0, 0.6), #123989, #296FFA, rgba(150, 0, 0, 0.6));
        color: white;
        border-radius: 50%;
    }
</style>

<script>
    // Obtén una lista de todos los botones de las unidades
    var buttons = document.querySelectorAll('.oval-button');
    var videoLinks = document.querySelectorAll('.btn-primary');

    // Función para manejar el clic en los botones de las unidades
    function handleButtonClick(titulo) {
        // Actualiza el contenido en la columna derecha con el título de la unidad
        var contenidoDerecha = document.querySelector('.col-md-8 h2');
        contenidoDerecha.textContent = titulo;

        // Oculta todos los botones de "Ver Videos"
        videoLinks.forEach(function(link) {
            link.style.display = 'none';
        });

        // Muestra el botón de "Ver Videos" correspondiente al título de la unidad
        var unidadIndex = Array.from(buttons).findIndex(function(button) {
            return button.textContent.trim() === titulo;
        });

        if (unidadIndex >= 0) {
            videoLinks[unidadIndex].style.display = 'block';
        }
    }

    // Asocia el evento de clic a cada botón de las unidades
    buttons.forEach(function (button) {
        button.addEventListener('click', function () {
            // Obtiene el título de la unidad del botón clicado
            var titulo = button.textContent.trim();

            // Llama a la función para manejar el clic y pasa el título de la unidad
            handleButtonClick(titulo);
        });
    });

    document.addEventListener('DOMContentLoaded', function() {
        // Encuentra el primer botón con la clase "selected"
        var selectedButton = document.querySelector('.oval-button.selected');

        // Si se encontró un botón seleccionado, simula un clic en él
        if (selectedButton) {
            selectedButton.click();
        }
    });

</script>
{% endblock %}
